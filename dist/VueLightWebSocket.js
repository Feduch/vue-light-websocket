'use strict';function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function _defineProperties(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}function _createClass(a,b,c){return b&&_defineProperties(a.prototype,b),c&&_defineProperties(a,c),a}var WebSocketClient=/*#__PURE__*/function(){function d(a,b){_classCallCheck(this,d),this.instance=null,this.isConnected=!1,this.url=a,this.options=b||this.defaultOptions(),this.options&&(this.reconnectEnabled=b.reconnectEnabled||!1,this.reconnectEnabled&&(this.reconnectInterval=b.reconnectInterval),this.token=b.token||null),this.onOpen=null,this.onMessage=null,this.onClose=null,this.onError=null}return _createClass(d,[{key:"defaultOptions",value:function(){return{reconnectEnabled:!1,reconnectInterval:0,token:null}}},{key:"connect",value:function(e){var f=this,a=null===this.token?e.token||null:this.token,b="".concat(this.url,"?token=").concat(a);this.instance=new WebSocket(b),this.instance.onopen=function(){f.isConnected=!0,"function"==typeof f.onOpen&&f.onOpen()},this.instance.onmessage=function(b){"function"==typeof f.onMessage&&f.onMessage(b)},this.instance.onclose=function(a){f.isConnected=!1,"function"==typeof f.onClose&&f.onClose(a),f.reconnectEnabled&&f.reconnect(e)},this.instance.onerror=function(b){"function"==typeof f.onError&&f.onError(b)}}},{key:"disconnect",value:function(){try{console.log("disconnect",this.instance),this.instance.close()}catch(b){console.warn("".concat(b," ").concat(this.instance))}delete this.instance}},{key:"reconnect",value:function(c){var a=this;try{this.instance.close()}catch(b){console.warn("".concat(b," ").concat(this.instance))}delete this.instance,setTimeout(function(){a.connect(c)},this.reconnectInterval)}},{key:"sendObj",value:function(b){this.instance.send(JSON.stringify(b))}},{key:"removeListeners",value:function(){this.onOpen=null,this.onMessage=null,this.onClose=null,this.onError=null}}]),d}(),Main={install:function(e,a){var b=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},c=new WebSocketClient(a,b);b.connectManually||c.connect(),e.prototype.$socketClient=c}};module.exports=Main;
//# sourceMappingURL=VueLightWebSocket.js.map
