{"version":3,"file":"VueLightWebSocket.js","sources":["../src/WebSocketClient.js","../src/Main.js"],"sourcesContent":["export default class WebSocketClient {\n  constructor (url, options) {\n    this.instance = null\n    this.isConnected = false\n    this.url = url\n    this.options = options || this.defaultOptions()\n    if (this.options) {\n      this.reconnectEnabled = options.reconnectEnabled || false\n      if (this.reconnectEnabled) {\n        this.reconnectInterval = options.reconnectInterval\n      }\n    }\n    // These methods should be defined by components\n    this.onOpen = null\n    this.onMessage = null\n    this.onClose = null\n    this.onError = null\n  }\n\n  defaultOptions () {\n    return {\n      reconnectEnabled: false,\n      reconnectInterval: 0\n    }\n  }\n\n  connect (token) {\n    const url = `${this.url}?token=${token}`\n    this.instance = new WebSocket(url)\n\n    // Socket event listeners\n    // Each event handler also calls the corresponding class method, which can be defined by the component\n    this.instance.onopen = () => {\n      this.isConnected = true\n      if (typeof this.onOpen === 'function') {\n        this.onOpen()\n      }\n    }\n    this.instance.onmessage = (msg) => {\n      if (typeof this.onMessage === 'function') {\n        this.onMessage(msg)\n      }\n    }\n    this.instance.onclose = (evt) => {\n      this.isConnected = false\n      if (typeof this.onClose === 'function') {\n        this.onClose(evt)\n      }\n      if (this.reconnectEnabled) {\n        this.reconnect()\n      }\n    }\n    this.instance.onerror = (evt) => {\n      if (typeof this.onError === 'function') {\n        this.onError(evt)\n      }\n    }\n  }\n\n  disconnect () {\n    try {\n      this.instance.close()\n    } catch (e) {\n      console.warn(`${e} ${this.instance}`)\n    }\n    delete this.instance\n  }\n\n  reconnect () {\n    try {\n      this.instance.close()\n    } catch (e) {\n      console.warn(`${e} ${this.instance}`)\n    }\n    delete this.instance\n    setTimeout(() => {\n      this.connect()\n    }, this.reconnectInterval)\n  }\n\n  sendObj (data) {\n    this.instance.send(JSON.stringify(data))\n  }\n\n  removeListeners () {\n    // removeListeners\n    this.onOpen = null\n    this.onMessage = null\n    this.onClose = null\n    this.onError = null\n  }\n}\n","import WebSocketClient from './WebSocketClient'\n\nexport default {\n  install (Vue, connection, options = {}) {\n    const socketClient = new WebSocketClient(connection, options)\n    if (!options.connectManually) {\n      socketClient.connect()\n    }\n    Vue.prototype.$socketClient = socketClient\n  }\n\n}\n"],"names":["WebSocketClient","url","options","instance","isConnected","defaultOptions","reconnectEnabled","reconnectInterval","onOpen","onMessage","onClose","onError","token","WebSocket","onopen","b","onmessage","msg","onclose","evt","reconnect","onerror","close","e","console","warn","setTimeout","a","connect","data","send","JSON","stringify","install","Vue","connection","socketClient","connectManually","prototype","$socketClient"],"mappings":"kZAAqBA,CAAAA,wCACnB,UAAA,CAAaC,CAAb,CAAkBC,CAAlB,CAA2B,yBACzB,KAAKC,QAAL,CAAgB,KAChB,KAAKC,WAAL,IACA,KAAKH,GAAL,CAAWA,EACX,KAAKC,OAAL,CAAeA,CAAO,EAAI,KAAKG,cAAL,GACtB,KAAKH,OAAL,GACF,KAAKI,gBAAL,CAAwBJ,CAAO,CAACI,gBAARJ,IAAxB,CACI,KAAKI,gBAAL,GACF,KAAKC,iBAAL,CAAyBL,CAAO,CAACK,iBAD/B,CAFF,EAOJ,KAAKC,MAAL,CAAc,KACd,KAAKC,SAAL,CAAiB,KACjB,KAAKC,OAAL,CAAe,KACf,KAAKC,OAAL,CAAe,kEAGC,CAChB,MAAO,CACLL,gBAAgB,GADX,CAELC,iBAAiB,CAAE,CAFd,kCAMAK,EAAO,YACRX,CAAG,WAAM,KAAKA,sBAAaW,GACjC,KAAKT,QAAL,CAAgB,GAAIU,CAAAA,SAAJ,CAAcZ,CAAd,CAAhB,CAIA,KAAKE,QAAL,CAAcW,MAAd,CAAuB,UAAM,CAC3BC,CAAI,CAACX,WAAL,GAAA,CAC2B,kBAAhBW,CAAAA,CAAI,CAACP,MAAW,EACzBO,CAAI,CAACP,MAAL,EATU,CAEd,CAUA,KAAKL,QAAL,CAAca,SAAd,CAA0B,SAACC,CAAD,CAAS,CACH,kBAAnBF,CAAAA,CAAI,CAACN,SAAc,EAC5BM,CAAI,CAACN,SAAL,CAAeQ,CAAf,CAdU,CAEd,CAeA,KAAKd,QAAL,CAAce,OAAd,CAAwB,SAACC,CAAD,CAAS,CAC/BJ,CAAI,CAACX,WAAL,GAAA,CAC4B,kBAAjBW,CAAAA,CAAI,CAACL,OAAY,EAC1BK,CAAI,CAACL,OAAL,CAAaS,CAAb,CAFF,CAIIJ,CAAI,CAACT,gBAAL,EACFS,CAAI,CAACK,SAAL,EAvBU,CAEd,CAwBA,KAAKjB,QAAL,CAAckB,OAAd,CAAwB,SAACF,CAAD,CAAS,CACH,kBAAjBJ,CAAAA,CAAI,CAACJ,OAAY,EAC1BI,CAAI,CAACJ,OAAL,CAAaQ,CAAb,uCAKQ,CACZ,GAAI,CACF,KAAKhB,QAAL,CAAcmB,KAAd,EACA,OAAOC,CAAP,CAAU,CACVC,OAAO,CAACC,IAARD,WAAgBD,cAAK,KAAKpB,SAA1BqB,CAEF,aAAYrB,4CAGD,YACX,GAAI,CACF,KAAKA,QAAL,CAAcmB,KAAd,EACA,OAAOC,CAAP,CAAU,CACVC,OAAO,CAACC,IAARD,WAAgBD,cAAK,KAAKpB,SAA1BqB,CAEF,aAAYrB,QAAZ,CACAuB,UAAU,CAAC,UAAM,CACfC,CAAI,CAACC,OAAL,EADQ,CAAA,CAEP,KAAKrB,iBAFE,kCAKHsB,EAAM,CACb,KAAK1B,QAAL,CAAc2B,IAAd,CAAmBC,IAAI,CAACC,SAALD,CAAeF,CAAfE,CAAnB,2CAGiB,CAEjB,KAAKvB,MAAL,CAAc,IAAd,CACA,KAAKC,SAAL,CAAiB,IADjB,CAEA,KAAKC,OAAL,CAAe,IAFf,CAGA,KAAKC,OAAL,CAAe,mBCvFJ,CACbsB,OADa,UACJC,EAAKC,EAA0B,IAAdjC,CAAAA,CAAc,wDAAJ,GAC5BkC,CAAY,CAAG,GAAIpC,CAAAA,eAAJ,CAAoBmC,CAApB,CAAgCjC,CAAhC,EAChBA,CAAO,CAACmC,eAARnC,EACHkC,CAAY,CAACR,OAAbQ,EADGlC,CAGLgC,CAAG,CAACI,SAAJJ,CAAcK,aAAdL,CAA8BE,CANnB,CAAA"}