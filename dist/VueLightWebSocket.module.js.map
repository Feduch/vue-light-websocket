{"version":3,"file":"VueLightWebSocket.module.js","sources":["../src/WebSocketClient.js","../src/Main.js"],"sourcesContent":["export default class WebSocketClient {\n  constructor (url, options) {\n    this.instance = null\n    this.isConnected = false\n    this.url = url\n    this.options = options || this.defaultOptions()\n    if (this.options) {\n      this.reconnectEnabled = options.reconnectEnabled || false\n      if (this.reconnectEnabled) {\n        this.reconnectInterval = options.reconnectInterval\n      }\n      // Token\n      this.token = options.token || null\n    }\n    // These methods should be defined by components\n    this.onOpen = null\n    this.onMessage = null\n    this.onClose = null\n    this.onError = null\n  }\n\n  defaultOptions () {\n    return {\n      reconnectEnabled: false,\n      reconnectInterval: 0,\n      token: null\n    }\n  }\n\n  connect () {\n    let token = this.token || null\n    const url = `${this.url}?token=${token}`\n    this.instance = new WebSocket(url)\n\n    // Socket event listeners\n    // Each event handler also calls the corresponding class method, which can be defined by the component\n    this.instance.onopen = () => {\n      this.isConnected = true\n      if (typeof this.onOpen === 'function') {\n        this.onOpen()\n      }\n    }\n    this.instance.onmessage = (msg) => {\n      if (typeof this.onMessage === 'function') {\n        this.onMessage(msg)\n      }\n    }\n    this.instance.onclose = (evt) => {\n      this.isConnected = false\n      if (typeof this.onClose === 'function') {\n        this.onClose(evt)\n      }\n      if (this.reconnectEnabled) {\n        this.reconnect()\n      }\n    }\n    this.instance.onerror = (evt) => {\n      if (typeof this.onError === 'function') {\n        this.onError(evt)\n      }\n    }\n  }\n\n  disconnect () {\n    try {\n      WebSocket.close()\n    } catch (e) {\n      console.warn(`WebSocket close ${e}`)\n    }\n    try {\n      this.instance.close()\n    } catch (e) {\n      console.warn(`${e} ${this.instance}`)\n    }\n    delete this.instance\n  }\n\n  reconnect () {\n    try {\n      this.instance.close()\n    } catch (e) {\n      console.warn(`${e} ${this.instance}`)\n    }\n    delete this.instance\n    setTimeout(() => {\n      this.connect()\n    }, this.reconnectInterval)\n  }\n\n  sendObj (data) {\n    this.instance.send(JSON.stringify(data))\n  }\n\n  removeListeners () {\n    // removeListeners\n    this.onOpen = null\n    this.onMessage = null\n    this.onClose = null\n    this.onError = null\n  }\n}\n","import WebSocketClient from './WebSocketClient'\n\nexport default {\n  install (Vue, connection, options = {}) {\n    const socketClient = new WebSocketClient(connection, options)\n    if (!options.connectManually) {\n      socketClient.connect()\n    }\n    Vue.prototype.$socketClient = socketClient\n  }\n\n}\n"],"names":["WebSocketClient","url","options","instance","isConnected","defaultOptions","reconnectEnabled","reconnectInterval","token","onOpen","onMessage","onClose","onError","WebSocket","onopen","a","onmessage","msg","onclose","evt","reconnect","onerror","close","e","console","warn","setTimeout","connect","data","send","JSON","stringify","install","Vue","connection","socketClient","connectManually","prototype","$socketClient"],"mappings":"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"}